insert into usuario(nome, email, senha)values('maria','maria@gmail.com','$2a$10$eACCYoNOHEqXve8aIWT8Nu3PkMXWBaOxJ9aORUYzfMQCbVBIhZ8tG');
insert into usuario(nome, email, senha)values('joana','joana@gmail.com','$2a$10$eACCYoNOHEqXve8aIWT8Nu3PkMXWBaOxJ9aORUYzfMQCbVBIhZ8tG');
insert into usuario(nome, email, senha)values('antonia','antonia@gmail.com','$2a$10$eACCYoNOHEqXve8aIWT8Nu3PkMXWBaOxJ9aORUYzfMQCbVBIhZ8tG');

insert into role(authority)values('ROLE_USUARIO');
insert into role(authority)values('ROLE_ADMIN');
insert into role(authority)values('ROLE_GERENTE');
insert into role(authority)values('ROLE_DESABILITADO');

insert into usuario_role(usuario_id,role_id)values(1,2);
insert into usuario_role(usuario_id,role_id)values(2,1);
insert into usuario_role(usuario_id,role_id)values(3,3);


INSERT INTO item VALUES (1400,'PARAF SEXT RI 3/16 X1/2BSW24 C5/16 A2,8 POLIDO',131,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1410,'PARAF SEXT RI 3/16 X 5/8 BSW24 C5/16 A2,8 POLIDO',58,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1420,'PARAF SEXT RI 3/16 X 3/4 BSW24 C5/16 A2,8 POLIDO',141,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1430,'PARAF SEXT RI 3/16 X 7/8 BSW24 C5/16 A2,8 POLIDO',91,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1440,'PARAF SEXT RI 3/16 X 1 BSW24 C5/16 A2,8 POLIDO',51,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1450,'PARAF SEXT RI 3/16 X 1-1/4 BSW24 C5/16 A2,8 POLIDO',66,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1460,'PARAF SEXT RI 3/16 X 1-1/2 BSW24 C5/16 A2,8 POLIDO',83,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1470,'PARAF SEXT RI 3/16 X 1-3/4 BSW24 C5/16 A2,8 POLIDO',147,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1480,'PARAF SEXT RI 3/16 X 2 BSW24 C5/16 A2,8 POLIDO',74,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1490,'PARAF SEXT RI 3/16 X 2-1/4 BSW24 C5/16 A2,8 POLIDO',78,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1500,'PARAF SEXT RI 3/16 X 2-1/2 BSW24 C5/16 A2,8 POLIDO',140,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1510,'PARAF SEXT RI 3/16 X 2-3/4 BSW24 C5/16 A2,8 POLIDO',124,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1520,'PARAF SEXT RI 3/16 X 3 BSW24 C5/16 A2,8 POLIDO',95,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1530,'PARAF SEXT RI 1/4 X 1/2 UNC20 C7/16 A3,8 POLIDO',70,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1540,'PARAF SEXT RI 1/4 X 5/8 UNC20 C7/16 A3,8 POLIDO',135,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1550,'PARAF SEXT RI 1/4 X 3/4 UNC20 C7/16 A3,8 POLIDO',133,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1560,'PARAF SEXT RI 1/4 X 7/8 UNC20 C7/16 A3,8 POLIDO',51,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1570,'PARAF SEXT RI 1/4 X 1 UNC20 C7/16 A3,8 POLIDO',125,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1580,'PARAF SEXT RI 1/4 X 1-1/4 UNC20 C7/16 A3,8 POLIDO',84,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1590,'PARAF SEXT RI 1/4 X 1-1/2 UNC20 C7/16 A3,8 POLIDO',65,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1600,'PARAF SEXT RI 1/4 X 1-3/4 UNC20 C7/16 A3,8 POLIDO',58,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1610,'PARAF SEXT RI 1/4 X 2 UNC20 C7/16 A3,8 POLIDO',96,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1620,'PARAF SEXT RI 1/4 X 2-1/4 UNC20 C7/16 A3,8 POLIDO',67,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1630,'PARAF SEXT RI 1/4 X 2-1/2 UNC20 C7/16 A3,8 POLIDO',83,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1640,'PARAF SEXT RI 1/4 X 2-3/4 UNC20 C7/16 A3,8 POLIDO',104,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1650,'PARAF SEXT RI 1/4 X 3 UNC20 C7/16 A3,8 POLIDO',56,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1660,'PARAF SEXT RI 1/4 X 3-1/2 UNC20 C7/16 A3,8 POLIDO',117,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1670,'PARAF SEXT RI 1/4 X 4 UNC20 C7/16 A3,8 POLIDO',92,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1680,'PARAF SEXT RI 1/4 X 4-1/2 UNC20 C7/16 A3,8 POLIDO',62,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1690,'PARAF SEXT RI 1/4 X 5 UNC20 C7/16 A3,8 POLIDO',101,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1700,'PARAF SEXT RI 1/4 X 5-1/2 UNC20 C7/16 A3,8 POLIDO',140,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1710,'PARAF SEXT RI 1/4 X 6 UNC20 C7/16 A3,8 POLIDO',94,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1720,'PARAF SEXT RI 5/16 X 1/2 UNC18 C1/2 A4,9 POLIDO',132,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1730,'PARAF SEXT RI 5/16 X 5/8 UNC18 C1/2 A4,9 POLIDO',141,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1740,'PARAF SEXT RI 5/16 X 3/4 UNC18 C1/2 A4,9 POLIDO',112,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1750,'PARAF SEXT RI 5/16 X 7/8 UNC18 C1/2 A4,9 POLIDO',82,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1760,'PARAF SEXT RI 5/16 X 1 UNC18 C1/2 A4,9 POLIDO',115,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1770,'PARAF SEXT RI 5/16 X 1-1/4 UNC18 C1/2 A4,9 POLIDO',141,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1780,'PARAF SEXT RI 5/16 X 1-1/2 UNC18 C1/2 A4,9 POLIDO',107,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1790,'PARAF SEXT RI 5/16 X 1-3/4 UNC18 C1/2 A4,9 POLIDO',80,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1800,'PARAF SEXT RI 5/16 X 2 UNC18 C1/2 A4,9 POLIDO',75,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1810,'PARAF SEXT RI 5/16 X 2-1/4 UNC18 C1/2 A4,9 POLIDO',62,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC'),(1820,'PARAF SEXT RI 5/16 X 2-1/2 UNC18 C1/2 A4,9 POLIDO',78,'PARAFUSOS','INDUSTRIALIZAÇÃO','PC');

INSERT INTO estoque VALUES (1,'1995-06-23',161,161,'A123',1400),(2,'2022-11-10',88,88,'A124',1410),(3,'1995-06-23',171,171,'A125',1420),(4,'2022-11-19',-35,121,'A126',1430),(5,'1995-06-23',81,81,'A127',1440),(6,'1995-06-23',96,96,'A128',1450),(7,'2022-11-11',169,169,'A129',1460),(8,'2022-11-22',93,177,'A130',1470),(9,'2022-11-19',121,33,'A131',1480),(10,'1995-06-23',108,108,'A132',1490),(11,'2022-11-21',198,118,'A133',1500),(12,'2022-11-23',123,156,'A134',1510),(13,'2022-11-08',250,250,'A135',1520),(14,'1995-06-23',37,37,'A136',1530),(15,'2022-11-18',111,77,'A137',1540),(16,'1995-06-23',163,163,'A138',1550),(17,'2022-11-08',65,65,'A139',1560),(18,'2022-11-07',216,216,'A140',1570),(19,'1995-06-23',114,114,'A141',1580),(20,'2022-11-12',20,20,'A142',1590),(21,'2022-11-24',157,88,'A143',1600),(22,'2022-11-22',140,126,'A144',1610),(23,'2022-11-21',-148,10,'A145',1620),(24,'2022-11-06',60,60,'A146',1630),(25,'2022-11-13',194,194,'A147',1640),(26,'1995-06-23',86,86,'A148',1650),(27,'1995-06-23',147,147,'A149',1660),(28,'2022-11-15',277,207,'A150',1670),(29,'2022-11-10',180,180,'A151',1680),(30,'2022-11-09',100,100,'A152',1690),(31,'2022-11-14',265,265,'A153',1700),(32,'2022-11-20',55,122,'A154',1710),(33,'1995-06-23',162,162,'A155',1720),(34,'2022-11-17',247,171,'A156',1730),(35,'1995-06-23',86,86,'A157',1740),(36,'2022-11-23',95,40,'A158',1750),(37,'1995-06-23',145,145,'A159',1760),(38,'1995-06-23',93,93,'A160',1770),(39,'2022-11-24',76,137,'A161',1780),(40,'1995-06-23',110,110,'A162',1790),(41,'2022-11-20',180,105,'A163',1800),(42,'2022-11-05',24,24,'A164',1810),(43,'1995-06-23',108,108,'A165',1820);

INSERT INTO previsao VALUES (1,'2022-12-19',0,'CP1000',95,1490,1),(2,'2022-12-18',0,'CP1001',75,1730,1),(3,'2022-12-17',0,'CP1002',92,1450,1),(4,'2022-12-16',0,'CP1003',69,1530,1),(5,'2022-12-15',0,'CP1004',90,1440,1),(6,'2022-12-14',0,'CP1005',53,1450,1),(7,'2022-12-13',0,'CP1006',93,1800,1),(8,'2022-12-12',0,'CP1007',63,1460,1),(9,'2022-12-11',0,'CP1008',81,1570,1),(10,'2022-12-10',0,'CP1009',75,1440,1),(11,'2022-12-09',1,'CP1010',75,1450,1),(12,'2022-12-08',1,'CP1011',88,1630,1),(13,'2022-12-07',1,'CP1012',72,1540,1),(14,'2022-12-06',1,'CP1013',81,1530,1),(15,'2022-12-05',1,'CP1014',79,1420,1),(16,'2022-12-04',1,'CP1015',72,1630,1),(17,'2022-12-03',1,'CP1016',66,1610,1),(18,'2022-12-02',1,'CP1017',94,1770,1),(19,'2022-12-01',1,'CP1018',51,1630,1),(20,'2022-11-30',1,'CP1019',81,1600,1);

INSERT INTO reserva VALUES (1,'2022-12-19',0,'PO1000',76,1420,1),(2,'2022-12-18',0,'PO1001',75,1580,1),(3,'2022-12-17',0,'PO1002',61,1610,1),(4,'2022-12-16',0,'PO1003',85,1460,1),(5,'2022-12-15',0,'PO1004',55,1800,1),(6,'2022-12-14',0,'PO1005',85,1540,1),(7,'2022-12-13',0,'PO1006',54,1690,1),(8,'2022-12-12',0,'PO1007',62,1490,1),(9,'2022-12-11',0,'PO1008',89,1800,1),(10,'2022-12-10',0,'PO1009',67,1470,1),(11,'2022-12-09',1,'PO1010',89,1500,1),(12,'2022-12-08',1,'PO1011',91,1620,1),(13,'2022-12-07',1,'PO1012',69,1560,1),(14,'2022-12-06',1,'PO1013',77,1660,1),(15,'2022-12-05',1,'PO1014',74,1750,1),(16,'2022-12-04',1,'PO1015',72,1660,1),(17,'2022-12-03',1,'PO1016',86,1710,1),(18,'2022-12-02',1,'PO1017',79,1550,1),(19,'2022-12-01',1,'PO1018',78,1560,1),(20,'2022-11-30',1,'PO1019',73,1490,1);

INSERT INTO movimentacao VALUES (1,'2022-12-09 00:00:00','PO1010',89,'OUT',11,1500,1),(2,'2022-12-06 00:00:00','PO1013',77,'OUT',27,1660,1),(3,'2022-12-03 00:00:00','PO1016',86,'OUT',32,1710,1),(4,'2022-12-02 00:00:00','PO1017',79,'OUT',16,1550,1),(5,'2022-11-30 00:00:00','PO1019',73,'OUT',10,1490,1),(6,'2022-12-09 00:00:00','CP1010',75,'IN',6,1450,1),(7,'2022-12-09 00:00:00','CP1011',88,'IN',24,1630,1),(8,'2022-12-08 00:00:00','CP1012',72,'IN',15,1540,1),(9,'2022-12-07 00:00:00','CP1013',81,'IN',14,1530,1),(10,'2022-12-07 00:00:00','CP1014',79,'IN',3,1420,1),(11,'2022-12-06 00:00:00','CP1015',72,'IN',24,1630,1),(12,'2022-12-05 00:00:00','CP1016',66,'IN',22,1610,1),(13,'2022-12-05 00:00:00','CP1017',94,'IN',38,1770,1),(14,'2022-12-05 00:00:00','CP1018',51,'IN',24,1630,1),(15,'2022-12-03 00:00:00','CP1019',81,'IN',21,1600,1),(16,'2022-12-14 15:23:45','avulso',40,'OUT',29,1680,1),(17,'2022-12-14 15:23:45','avulso',58,'OUT',7,1460,1),(18,'2022-12-14 15:23:45','avulso',63,'OUT',13,1520,1),(19,'2022-12-14 15:23:45','avulso',43,'OUT',17,1560,1),(20,'2022-12-14 15:23:45','avulso',48,'OUT',39,1780,1),(21,'2022-12-14 15:23:45','avulso',72,'OUT',19,1580,1),(22,'2022-12-14 15:23:45','avulso',20,'OUT',28,1670,1);

# ATUALIZA estoque futuro baseado nas previsoes e reservas.
Update estoque as e, (select e_futuro.item, (e_futuro.qtdAcum + e.estoque_real) as estoqueFuturo, e_futuro.data  from (select sum(t1.qtd) as qtdAcum, max(t1.data) as data, t1.item from (select 'Previsao' as tipo, p.quantidade_prevista as qtd, p.data_prevista as data, p.item_id_item as item from previsao as p where p.finalizada = false union select 'Reserva' as tipo ,-r.quantidade_reserva as qtd, r.data_prevista as data, r.item_id_item as item from reserva as r where r.finalizada = false) as t1 group by t1.item) as e_futuro inner join estoque as e on e_futuro.item = e.item_id_item) as res set e.estoque_futuro = res.estoqueFuturo, e.data_futura = res.data where e.item_id_Item = res.item;

CREATE OR REPLACE VIEW `log_futuro` AS select `previsao`.`item_id_item` AS `id_item`,'Previsão' AS `tipo_movimentacao`,`previsao`.`data_prevista` AS `data`,`previsao`.`ordem` AS `origem_destino`,`previsao`.`quantidade_prevista` AS `quantidade`,0 AS `estoque_momento` from `previsao` where (`previsao`.`finalizada` = false) union select `reserva`.`item_id_item` AS `id_item`,'Reserva' AS `tipo_movimentacao`,`reserva`.`data_prevista` AS `data`,`reserva`.`ordem` AS `origem_destino`,-(`reserva`.`quantidade_reserva`) AS `quantidade`,0 AS `estoque_momento` from `reserva` where (`reserva`.`finalizada` = false) order by 'data';
